<app-patientdetailsdashboard></app-patientdetailsdashboard>

<div class="container">
    <div class="row">
        <div class="col">
            <div class="card col-12 col-md-4 mt-5">
                <div class="text-center">
                    <h2>Allergy Information</h2>
                </div>
                
<form [formGroup]="allergyForm" (ngSubmit)="onSubmit()">

    <div class="form-group mb-3">
        <label class="col-sm-12 control-label">Patient has any known allergies</label>
        <div class="col-sm-12">
            <label class="radio-inline col-sm-3"> <input  [(ngModel)]="type" class="form-check-input" formControlName="hasallergy"  type="radio" name="hasallergy" id="hasallergyYes" [value]="1"> Yes </label>
            <label class="radio-inline col-sm-3"> <input  [(ngModel)]="type" class="form-check-input" formControlName="hasallergy" type="radio" name="hasallergy" id="hasallergyNo" [value]="0"> No </label>
          </div>
    </div>

    <div *ngIf="type == 1">
        <div class="mb-3">
            <label for="allergyId">Allergy Id </label>
            <div class="mb-3">
                <input class="form-control" list="allergyid" formControlName="allergyId" [(ngModel)]="allergyIdDdl" (change)="showOtherFieldsOnAllergyId()" [value]="showAllergyId" placeholder="Enter WHO/IUIS Allergen Nomenclature ID, if known">
                    <datalist id="allergyid">
                    <option *ngFor="let allergy of allergies">
                            {{allergy.allergyId}}
                    </datalist>       
            </div>
        </div>

         <!-- <select class="form-control" formControlName="id">  
                    <option *ngFor="let allergy of allergies">{{allergy.id}}</option>  
                </select>   -->
       
        <div class="mb-3">
            <label for="allergytype">Allergy Type </label>
            <div class="mb-3">
                <input class="form-control" list="allergytype" formControlName="allergyType" [value]="showAllergyType">
                    <datalist id="allergytype">
                    <option *ngFor="let allergy of allergies">
                        {{allergy.allergytype}}
                    </datalist>
            </div>
        </div>      
      
        <div class="form-group mb-3">
            <label for="allergyname">Allergy Name </label>
            <div class="mb-3">                
                <input class="form-control" [(ngModel)]="allergynameddl" [value]="showAllergyName" list="allergyname" formControlName="allergyName" (change)="showClinicalInfoandAllergyIdOnAllergyName()">
                    <datalist id="allergyname">                      
                    <option *ngFor="let allergy of allergies">
                        {{allergy.allergyname}}
                    </datalist>
            </div>
            <input type="text" class="form-control" formControlName="allergyName" *ngIf="allergynameddl=='Other'" [(ngModel)]="allergynameddl">           
            <span class="text-danger" *ngIf="allergyForm.controls['allergyName'].touched && allergyForm.hasError('required','allergyName')">This field cannot be empty.</span>
        </div>       
       
        <div class="form-group mb-3">
            <label for="allergydescription" class="form-label">Allergy Description </label>
            <textarea id="allergydescription" rows="3" class="form-control" type="text" formControlName="allergydescription"></textarea>
            <span class="text-danger" *ngIf="allergyForm.controls['allergydescription'].touched && allergyForm.hasError('required','allergydescription')">This field cannot be empty.</span>
            <span class="text-danger" *ngIf="allergyForm.controls['allergydescription'].dirty && allergyForm.hasError('minlength','allergydescription')">Description should be more than 50 letters.</span>
            <span class="text-danger" *ngIf="allergyForm.controls['allergydescription'].dirty && allergyForm.hasError('maxlength','allergydescription')">Description should be more than 1000 letters.</span>
        </div>
    
        <div class="form-group mb-3">
            <label for="allergyclinicalinfo">Allergy Clinical Information </label>
            <input id="allergyclinicalinfo" type="text" formControlName="clinicalInfo" class="form-control mb-3" [value]="showClinicalInfo">            
        </div>
    

        <div class="form-group mb-3">
            <label class="col-sm-4 control-label" for="isfatal">Is Allergy Fatal?</label>
            <div class="col-sm-12">
                <label class="radio-inline col-sm-3"> <input class="form-check-input" formControlName="isfatal"  type="radio" name="isfatal" id="isfatalYes" value="Yes"> Yes </label>
                <label class="radio-inline col-sm-3"> <input class="form-check-input" formControlName="isfatal" type="radio" name="isfatal" id="isfatalNo" value="No"> No </label>
              </div>             
            <span class="text-danger" *ngIf="allergyForm.controls['isfatal'].touched && allergyForm.hasError('required','isfatal')">Kindly provide a response.</span>
        </div>
    
        <button type="submit"  class="btn btn-primary">Submit</button>&nbsp;
        <button type="reset"  class="btn btn-primary">Reset</button>
    </div>   
  
  </form>
                 

            </div>
        </div>
    </div>
</div>
